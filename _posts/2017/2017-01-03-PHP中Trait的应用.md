---
layout: post
title: "PHP中Trait的应用"
tags: [PHP]
author_name: R_Lanffy
---
---

# PHP中Trait的应用

从PHP的5.4.0版本开始,PHP提供了一种全新的代码复用的概念,那就是Trait。Trait其字面意思是"特性"、"特点",我们可以理解为,使用Trait关键字,可以为PHP中的类添加新的特性。

熟悉面向对象的都知道,软件开发中常用的代码复用有继承和多态两种方式。在PHP中,只能实现单继承。而Trait则避免了这点。下面通过简单的额例子来进行对比说明。

## 继承 VS 多态 VS Trait

现在有``Publish.php``和``Answer.php``这两个类。要在其中添加LOG功能,记录类内部的动作。有以下几种方案:

1. 继承
2. 多态
3. Trait

### 继承

如图:

代码结构如下:

```php
// Log.php
Class Log
{
    public function startLog()
    {
        // echo ...
    }

    public function endLog()
    {
        // echo ...
    }
}
```

```php
// Publish.php
Class Publish extends Log
{

}
```

```php
// Answer.php
Class Answer extends Log
{
    
}
```

可以看到继承的确满足了要求。但这却违背了面向对象的原则。而发布(Publish)和回答(Answer)这样的操作和日志(Log)之间的关系并不是子类与父类的关系。所以不推荐这样使用。

### 多态

如图:

实现代码:

```php
// Log.php
Interface Log
{
    public function startLog();
    public function endLog();
}
```

```php
// Publish.php
Class Publish implements Log
{
    public function startLog()
    {
        // TODO: Implement startLog() method.
    }
    public function endLog()
    {
        // TODO: Implement endLog() method.
    }
}
```

```php
// Answer.php
Class Answer implements Log
{
    public function startLog()
    {
        // TODO: Implement startLog() method.
    }
    public function endLog()
    {
        // TODO: Implement endLog() method.
    }
}
```

记录日志的操作应该都是一样的,因此,发布(Publish)和回答(Answer)动作中的日志记录实现也是一样的。很明显,这违背了DRY(Don't Repeat Yourself)原则。所以是不推荐这样实现的。


